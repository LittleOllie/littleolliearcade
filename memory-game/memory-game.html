<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Little Ollie Memory Game</title>

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: radial-gradient(circle at top, #6de0ff, #4c6fff);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  color: #fff;
}

.game-wrapper {
  background: rgba(0,0,0,0.18);
  border-radius: 20px;
  padding: 16px;
  box-shadow: 0 12px 28px rgba(0,0,0,0.35);
  width: 960px;
  max-width: 96vw;
}

.header-image {
  width: 100%;
  margin-bottom: 10px;
}

.stats {
  font-size: 15px;
  margin-bottom: 10px;
  display: flex;
  justify-content: space-between;
  flex-wrap: wrap;
}

#restartBtn {
  padding: 8px 16px;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  background: #ffdd55;
  color: #222;
  font-weight: 700;
  margin-bottom: 12px;
}

.game-board {
  display: grid;
  gap: 10px;
}

.card {
  aspect-ratio: 1 / 1;
  perspective: 800px;
  cursor: pointer;
  transition: transform 0.45s cubic-bezier(.22,.61,.36,1);
}

.card-inner {
  width: 100%;
  height: 100%;
  transition: transform 0.35s ease;
  transform-style: preserve-3d;
}

.card.flipped .card-inner,
.card.matched .card-inner {
  transform: rotateY(180deg);
}

.card-face {
  position: absolute;
  inset: 0;
  border-radius: 12px;
  backface-visibility: hidden;
  display: flex;
  justify-content: center;
  align-items: center;
  background: #fff;
  border: 3px solid #111;
}

.card-back img { max-width: 80%; }
.card-front { transform: rotateY(180deg); }
.card-front img { max-width: 90%; }

.card.matched .card-front {
  background: #d1fae5;
  border-color: #10b981;
}

/* Wiggle */
@keyframes wiggle {
  0% { transform: translate(0,0) rotate(0); }
  25% { transform: translate(2px,-2px) rotate(-2deg); }
  50% { transform: translate(-2px,2px) rotate(2deg); }
  75% { transform: translate(1px,-1px) rotate(-1deg); }
  100% { transform: translate(0,0) rotate(0); }
}
.card.wiggle { animation: wiggle 0.35s ease; }

/* Overlay */
.overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.6);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 20;
}

.overlay-box {
  background: rgba(255,255,255,.18);
  backdrop-filter: blur(12px);
  border-radius: 20px;
  padding: 24px;
  text-align: center;
  box-shadow: 0 20px 50px rgba(0,0,0,.5);
}

.overlay-box button {
  padding: 12px 20px;
  margin: 6px;
  border-radius: 14px;
  border: none;
  background: #ffdd55;
  font-weight: 800;
  cursor: pointer;
}

/* Confetti */
.confetti {
  position: fixed;
  top: -10px;
  width: 10px;
  height: 14px;
  animation: fall linear forwards;
}
@keyframes fall {
  to { transform: translateY(110vh) rotate(360deg); }
}
</style>
</head>

<body>

<!-- START -->
<div class="overlay" id="startOverlay">
  <div class="overlay-box">
    <h2>Choose Difficulty</h2>
    <button data-diff="easy">Easy (20)</button>
    <button data-diff="medium">Medium (30)</button>
    <button data-diff="hard">Hard (42)</button>
  </div>
</div>

<!-- WIN -->
<div class="overlay" id="winOverlay" style="display:none">
  <div class="overlay-box">
    <h2>üéâ You Win! üéâ</h2>
    <p id="winStats"></p>
    <button onclick="location.reload()">Play Again</button>
  </div>
</div>

<div class="game-wrapper">
  <img src="header.png" class="header-image" />

  <div class="stats">
    <div>Moves: <span id="moves">0</span></div>
    <div>Matches: <span id="matches">0</span>/<span id="total">0</span></div>
    <div>Time: <span id="time">0</span>s</div>
  </div>

  <button id="restartBtn">üîÅ Restart</button>
  <div class="game-board" id="board"></div>
</div>

<script>
/* MOBILE */
const isMobile = window.innerWidth <= 768;

/* CONFIG */
const ALL_IMAGES = [...Array(22)].map((_,i)=>`${i+1}.png`);
const DIFFS = {
  easy:   { pairs:10, cols:isMobile?4:5 },
  medium: { pairs:15, cols:isMobile?5:6 },
  hard:   { pairs:21, cols:isMobile?6:7 }
};

/* AUDIO */
const flipSound = new Audio("flip.wav");

const correctSounds = [
  "tick1.wav","tick2.wav","tick3.wav","tick4.wav","tick5.wav"
].map(f => new Audio(f));

const wrongSounds = [
  "wrong1.wav","wrong2.wav","wrong3.wav","wrong4.wav","wrong5.wav"
].map(f => new Audio(f));

[flipSound, ...correctSounds, ...wrongSounds].forEach(s => s.volume = 0.75);

function playFlip(){
  try{ flipSound.currentTime=0; flipSound.play(); }catch{}
}
function playCorrect(){
  const s = correctSounds[Math.floor(Math.random()*correctSounds.length)];
  try{ s.currentTime=0; s.play(); }catch{}
}
function playWrong(){
  const s = wrongSounds[Math.floor(Math.random()*wrongSounds.length)];
  try{ s.currentTime=0; s.play(); }catch{}
}

/* DOM */
const board = document.getElementById("board");
const startOverlay = document.getElementById("startOverlay");
const winOverlay = document.getElementById("winOverlay");
const winStats = document.getElementById("winStats");
const movesEl = document.getElementById("moves");
const matchesEl = document.getElementById("matches");
const totalEl = document.getElementById("total");
const timeEl = document.getElementById("time");
const restartBtn = document.getElementById("restartBtn");

/* STATE */
let cards=[], flipped=[], lock=true;
let moves=0, matches=0, totalPairs=0;
let seconds=0, timer=null;

/* UTILS */
const shuffle = a => {
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
};

function startTimer(){
  timer=setInterval(()=>{seconds++;timeEl.textContent=seconds},1000);
}

/* CONFETTI */
function launchConfetti(){
  for(let i=0;i<120;i++){
    const c=document.createElement("div");
    c.className="confetti";
    c.style.left=Math.random()*100+"vw";
    c.style.background=`hsl(${Math.random()*360},90%,60%)`;
    c.style.animationDuration=2+Math.random()*3+"s";
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),5000);
  }
}

/* START GAME */
function startGame(diff){
  startOverlay.style.display="none";
  const cfg=DIFFS[diff];
  totalPairs=cfg.pairs;
  totalEl.textContent=totalPairs;
  board.style.gridTemplateColumns=`repeat(${cfg.cols},1fr)`;

  const chosen = shuffle([...ALL_IMAGES]).slice(0,totalPairs);
  const paired=[];
  chosen.forEach(i=>paired.push(i,i));
  cards = paired.map((img,i)=>({id:i,img,matched:false}));

  board.innerHTML="";
  cards.forEach(c=>{
    const d=document.createElement("div");
    d.className="card";
    d.dataset.id=c.id;
    d.innerHTML=`
      <div class="card-inner">
        <div class="card-face card-back"><img src="logo.png"></div>
        <div class="card-face card-front"><img src="${c.img}"></div>
      </div>`;
    board.appendChild(d);
  });

  previewAndShuffle();
}

/* PREVIEW + SHUFFLE */
async function previewAndShuffle(){
  const els=[...document.querySelectorAll(".card")];
  els.forEach(c=>c.classList.add("flipped"));
  await new Promise(r=>setTimeout(r,1600));
  els.forEach(c=>c.classList.remove("flipped"));
  await new Promise(r=>setTimeout(r,300));

  els.forEach(c=>c.classList.add("wiggle"));
  await new Promise(r=>setTimeout(r,350));
  els.forEach(c=>c.classList.remove("wiggle"));

  const first=new Map();
  els.forEach(c=>first.set(c,c.getBoundingClientRect()));
  shuffle(els).forEach(c=>board.appendChild(c));
  els.forEach(c=>{
    const last=c.getBoundingClientRect();
    const f=first.get(c);
    c.style.transform=`translate(${f.left-last.left}px,${f.top-last.top}px)`;
  });
  requestAnimationFrame(()=>els.forEach(c=>c.style.transform=""));

  lock=false;
  startTimer();
}

/* GAMEPLAY */
board.addEventListener("click",e=>{
  const card=e.target.closest(".card");
  if(!card||lock||card.classList.contains("matched"))return;

  const id=+card.dataset.id;
  if(flipped.some(f=>f.id===id))return;

  card.classList.add("flipped");
  playFlip();
  flipped.push({id,img:cards[id].img,el:card});

  if(flipped.length===2){
    lock=true;
    moves++; movesEl.textContent=moves;
    const[a,b]=flipped;

    if(a.img===b.img){
      playCorrect();
      a.el.classList.add("matched");
      b.el.classList.add("matched");
      matches++; matchesEl.textContent=matches;
      flipped=[]; lock=false;

      if(matches===totalPairs){
        clearInterval(timer);
        launchConfetti();
        winStats.textContent=`${moves} moves ¬∑ ${seconds}s`;
        winOverlay.style.display="flex";
      }
    }else{
      playWrong();
      setTimeout(()=>{
        a.el.classList.remove("flipped");
        b.el.classList.remove("flipped");
        flipped=[]; lock=false;
      },850);
    }
  }
});

restartBtn.onclick=()=>location.reload();
document.querySelectorAll("#startOverlay button")
  .forEach(b=>b.onclick=()=>startGame(b.dataset.diff));
</script>
</body>
</html>
